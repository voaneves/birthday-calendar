document.addEventListener("DOMContentLoaded",function(){function t(){v=!v,localStorage.setItem("sorted",JSON.stringify(v)),s()}function e(){f=!0,localStorage.setItem("isModalDismissed",JSON.stringify(f)),g.classList.remove("open")}function n(t){const e=t.closest("tr"),n=h.find(t=>t.nome===e.cells[0].textContent),o=prompt("Novo nome:",n.nome);if(!o)return;const a=prompt("Nova data:",n.data);a&&(n.nome=o,n.data=a,S=r(h),d(),s())}function o(t){const e=t.closest("tr"),n=e.rowIndex-1;n<0||n>=h.length||(h.splice(n,1),S=r(h),d(),u.deleteRow(n+1))}function a(t){const[e,n,o]=t.split("/"),a=new Date(`${o}-${n}-${e}`),s=Date.now(),r=s-a.getTime(),c=Math.floor(r/31536e6);return c}function s(){u.innerHTML="<tr>\n        <th>Nome</th>\n        <th>Data</th>\n        <th>Idade</th>\n        <th>Ações</th>\n      </tr>";const t=v?S:h;t.forEach(t=>{const e=u.insertRow();e.innerHTML=`\n          <td>${t.nome}</td>\n          <td>${t.data.substring(0,5)}</td>\n          <td>${a(t.data)}</td>\n          <td>\n            <button class="editar">Editar</button>\n            <button class="remover">Remover</button>\n          </td>\n        `})}function r(t){const e=new Date,n=[...t].sort((t,n)=>{const o=c(t.data,e),a=c(n.data,e);return o-a});return n}function c(t,e){const[n,o,a]=t.split("/"),s=new Date(e.getFullYear(),o-1,n);return(s.getMonth()<e.getMonth()||s.getMonth()===e.getMonth()&&s.getDate()<e.getDate())&&s.setFullYear(e.getFullYear()+1),s}function d(){localStorage.setItem("aniversarios",JSON.stringify(h)),localStorage.setItem("aniversariosSorted",JSON.stringify(S))}function i(){const t=document.querySelector(".theme");t.addEventListener("click",l)}function l(){const t=window.matchMedia("(prefers-color-scheme: dark)");document.body.classList.toggle(t.matches?"light-mode":"dark-mode")}const m=document.getElementById("form"),u=document.getElementById("tabela"),g=document.getElementById("modal-one");let f=JSON.parse(localStorage.getItem("isModalDismissed"))||!1,h=JSON.parse(localStorage.getItem("aniversarios"))||[],S=JSON.parse(localStorage.getItem("aniversariosSorted"))||[],v=JSON.parse(localStorage.getItem("sorted"))||!1;const I=document.getElementById("sort"),p=document.getElementById("checkbox");if(I.addEventListener("click",t),p.checked=v,!f){g.classList.add("open");const t=g.querySelectorAll(".modal-exit");t.forEach(t=>{t.addEventListener("click",e)})}m.addEventListener("submit",function(t){t.preventDefault();const e=document.getElementById("nome").value,n=new Date(document.getElementById("data").value).toLocaleDateString(void 0,{timeZone:"UTC"});e&&n&&(h.push({nome:e,data:n}),S=r(h),d(),m.reset(),s())}),u.addEventListener("click",function(t){const e=t.target;e.matches("button.editar")?n(e):e.matches("button.remover")&&o(e)}),m.reset(),s(),i()});
