document.addEventListener("DOMContentLoaded",function(){function t(){f=!f,localStorage.setItem("sorted",JSON.stringify(f)),a()}function e(t){const e=t.closest("tr"),n=u.find(t=>t.nome===e.cells[0].textContent),o=prompt("Novo nome:",n.nome);if(o){n.nome=o;const t=prompt("Nova data:",n.data);t&&(n.data=t,g=r(u),d(),a())}}function n(t){const e=t.closest("tr"),n=e.rowIndex-1;n>=0&&n<u.length&&(u.splice(n,1),g=r(u),d(),m.deleteRow(n+1))}function o(t){const[e,n,o]=t.split("/"),a=new Date(`${o}-${n}-${e}`),r=Date.now(),c=r-a.getTime(),d=Math.floor(c/315576e5);return d}function a(){m.innerHTML="<tr>\n        <th>Nome</th>\n        <th>Data</th>\n        <th>Idade</th>\n        <th>Ações</th>\n      </tr>";const t=f?g:u;t.forEach(t=>{const e=m.insertRow();e.innerHTML=`\n          <td>${t.nome}</td>\n          <td>${t.data.substring(0,5)}</td>\n          <td>${o(t.data)}</td>\n          <td>\n            <button class="editar">Editar</button>\n            <button class="remover">Remover</button>\n          </td>\n        `})}function r(t){const e=new Date,n=[...t].sort((t,n)=>{const o=c(t.data,e),a=c(n.data,e);return o-a});return n}function c(t,e){const[n,o,a]=t.split("/"),r=new Date(e.getFullYear(),o-1,n);return(r.getMonth()<e.getMonth()||r.getMonth()===e.getMonth()&&r.getDate()<e.getDate())&&r.setFullYear(e.getFullYear()+1),r}function d(){localStorage.setItem("aniversarios",JSON.stringify(u)),localStorage.setItem("aniversariosSorted",JSON.stringify(g))}function s(){const t=document.querySelector(".theme");t.addEventListener("click",i)}function i(){const t=window.matchMedia("(prefers-color-scheme: dark)");document.body.classList.toggle(t.matches?"light-mode":"dark-mode")}const l=document.getElementById("form"),m=document.getElementById("tabela");let u=JSON.parse(localStorage.getItem("aniversarios"))||[],g=JSON.parse(localStorage.getItem("aniversariosSorted"))||[],f=JSON.parse(localStorage.getItem("sorted"))||!1;document.getElementById("sort").addEventListener("click",t),document.getElementById("checkbox").checked=f,l.addEventListener("submit",function(t){t.preventDefault();const e=document.getElementById("nome").value,n=new Date(document.getElementById("data").value).toLocaleDateString(void 0,{timeZone:"UTC"});e&&n&&(u.push({nome:e,data:n}),g=r(u),d(),l.reset(),a())}),m.addEventListener("click",function(t){const o=t.target;o.matches("button.editar")?e(o):o.matches("button.remover")&&n(o)}),l.reset(),a(),s()}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("modal-one");let e=JSON.parse(localStorage.getItem("modalClicked"))||!1;if(!clicked){t.classList.add("open");const n=t.querySelectorAll(".modal-exit");n.forEach(function(n){n.addEventListener("click",function(n){e=!0,localStorage.setItem("modalClicked",JSON.stringify(sorted)),n.preventDefault(),t.classList.remove("open")})})}});